# MEMO

## GraphQL

APIのクエリ言語
クライアントのための言語。
クライアント（≒画面表示）が欲しいデータの構造をそのまま要求できる。

クライアントに対するプレゼンテーション層。（！＝ビジネスロジック）

結果は、ツリー構造で得られる。

### Server-Side

Resolverの集合。ツリー構造をルートから対応するResolverを当て込みながら処理していく。Visitorパターン？

## 命名規則

### Query

名詞。リソース名（単数or複数）

### Mutation

動詞＋名詞

## ID

`ITEM_ID:001`のような人の目で見てわかるものにするか、符号化ないし暗号化した値にするか。

## Rate Limit

高コストクエリ乱発への警戒。仕様として制限を設ける検討。

## Paging

Cursor Connections

レスポンスに、リストのみでなくConnectionサフィックスを付加。

Connectionサフィックスは、`pageInfo`（ページングに関する情報）と`edges`（cursor文字列）を持つ。

検索条件は、`xxxxInput`として持つ？

そもそも、仕様としてページングを諦めるのが吉。

表示データ増加は無限スクロール形式とし、データの絞り込みには検索フィルタを使うのがモダンなやり方。

## Mutations Updater

削除したら、削除IDを必ずレスポンスに含める。

## RDBとの対応

N+1問題を避ける。同一IDに紐づくクエリをID数分ではなくIN句にまとめ直す等。

`gqlgen`では`dataloaden`を使う。

## スキーマ定義のファイル分割

`extend`を使う。
